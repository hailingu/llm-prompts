# ============================================================
# ppt-slide-layout-library / layouts.yml
# 布局类型库 — 8种布局 + HTML模板 + 版式约束 + 选择指南 + 页面级约束
# ============================================================

# ╔══════════════════════════════════════════════════════════╗
# ║  0. 通用约束                                            ║
# ╚══════════════════════════════════════════════════════════╝

general:
  four_section_structure: |
    每页必须包含"标题区 + 主内容区 + 洞察区 + 页脚信息区"四段结构（封面/尾页除外）。
    缺失任一段时，需要说明原因并提供视觉等价替代。

# ╔══════════════════════════════════════════════════════════╗
# ║  1. 布局定义                                            ║
# ╚══════════════════════════════════════════════════════════╝

layouts:

  # ──────────────────────────────────────────────────────────
  # 1.1 封面布局 (cover)
  # ──────────────────────────────────────────────────────────
  cover:
    name: 封面布局
    template: |
      <div class="slide-container">
        <div class="sidebar bg-kpmg-blue">品牌区域</div>
        <div class="content-area">标题、副标题、元数据</div>
      </div>
    constraints:
      - "首页默认必须使用 cover 布局；除非用户显式要求'目录型/摘要型首页'，不得使用 data-chart/hybrid/dashboard"
      - "正文抑制：封面不得出现大段分析正文（≤2条短句，总计≤80中文字符），禁止'左大卡+右信息卡'正文页结构"
      - "层级结构：必须包含 eyebrow + 主标题 + 副标题/英文标题 + 元信息 四层信息，不要求洞察三段式"
      - "视觉重心：标题与品牌元素为重心，辅助信息仅元数据"
      - "页脚策略：可保留简化页脚（页码+数据口径其一），不得引入分析型脚注"

  # ──────────────────────────────────────────────────────────
  # 1.2 数据图表布局 (data-chart)
  # ──────────────────────────────────────────────────────────
  data_chart:
    name: 数据图表布局
    template: |
      <div class="slide-container">
        <div class="flex gap-4 h-[600px]">
          <section class="w-7/12 card p-4 flex flex-col min-h-0">
            <p class="text-sm font-semibold mb-2">图表标题</p>
            <div class="chart-wrap flex-1 min-h-0"><canvas id="mainChart"></canvas></div>
          </section>
          <aside class="w-5/12 flex flex-col gap-4">
            <div class="card p-4 flex-1">洞察 A</div>
            <div class="card p-4 flex-1">洞察 B</div>
          </aside>
        </div>
      </div>
    constraints:
      - "图表优先：左侧图表区宽度必须 ≥ 58% (w-7/12)，保证数据可视性"
      - "右侧对齐：右侧洞察卡数量建议 2-3 张，总高度自适应填满，底部也不许留白"

  # ──────────────────────────────────────────────────────────
  # 1.3 仪表盘网格布局 (dashboard_grid) - 新增受控即兴
  # ──────────────────────────────────────────────────────────
  dashboard_grid:
    name: 仪表盘网格布局
    template: |
      <div class="slide-container">
        <div class="grid grid-cols-12 gap-4 h-full">
          <!-- 上半部分：核心指标或小图 -->
          <div class="col-span-3 card p-3 flex flex-col justify-center items-center">
            <div class="text-3xl font-bold text-brand-primary">KPI_1</div>
            <div class="text-xs text-slate-500">Metric Label</div>
          </div>
          <div class="col-span-3 card p-3 flex flex-col justify-center items-center">
            <div class="text-3xl font-bold text-brand-secondary">KPI_2</div>
            <div class="text-xs text-slate-500">Metric Label</div>
          </div>
          <div class="col-span-6 card p-3">
            <p class="text-xs font-bold mb-1">Mini Trend</p>
            <div class="h-20"><canvas id="miniChart1"></canvas></div>
          </div>
          
          <!-- 下半部分：主图与详细分析 -->
          <div class="col-span-8 card p-4 h-[380px]">
             <p class="text-sm font-semibold mb-2">Main Analysis</p>
             <div class="h-full w-full"><canvas id="mainDashboardChart"></canvas></div>
          </div>
          <div class="col-span-4 flex flex-col gap-4 h-[380px]">
             <div class="card p-4 flex-1 bg-slate-50 border-l-4 border-brand-primary">
               <p class="font-bold text-sm mb-1">Key Insight</p>
               <p class="text-xs leading-relaxed">Analysis text...</p>
             </div>
             <div class="card p-4 flex-1">
               <p class="font-bold text-sm mb-1">Recommendation</p>
               <p class="text-xs leading-relaxed">Action item...</p>
             </div>
          </div>
        </div>
      </div>
    constraints:
      - "网格对齐：必须严格遵守 12 列栅格系统，禁止出现 col-span-5.5 这种非整数"
      - "模块化组合：允许根据内容将 col-span-3/4/6/8 自由组合，但行高必须对齐"
      - "内容密度：适用于多维度数据展示，单页图表数建议 2-4 个（1大+N小）"
      - "视觉层级：大图必须占据主导位置（至少 col-span-8 或 row-span-2）"

  # ──────────────────────────────────────────────────────────
            <div class="card p-4 h-[280px]">
              <div class="chart-wrap h-[240px]"><canvas id="subChart"></canvas></div>
            </div>
            <div class="card p-4 flex-1 min-h-0">洞察卡片</div>
          </aside>
        </div>
      </div>

  # ──────────────────────────────────────────────────────────
  # 1.3 并排比较布局 (side-by-side)
  # ──────────────────────────────────────────────────────────
  side_by_side:
    name: 并排比较布局
    template: |
      <div class="slide-container">
        <div class="grid grid-cols-2 gap-4 h-[520px]">
          <section class="card p-4 flex flex-col h-full min-h-0">
            <div class="chart-wrap h-[320px] min-h-0"><canvas id="chart1"></canvas></div>
            <div class="mt-3 flex-1 min-h-0">底部洞察/KPI（结论/原因/建议）</div>
          </section>
          <section class="card p-4 flex flex-col h-full min-h-0">
            <div class="chart-wrap h-[320px] min-h-0"><canvas id="chart2"></canvas></div>
            <div class="mt-3 flex-1 min-h-0">底部洞察/KPI（结论/原因/建议）</div>
          </section>
        </div>
      </div>
    constraints:
      equal_height:
        - "默认同高：两侧主图容器高度必须一致（chart1_height == chart2_height），避免底部留白不一致"
        - "主次图例外：仅当明确标注'主图/辅图'语义时允许不等高；高度差≤15%"
        - "底边对齐：并排两卡底边必须对齐，正文/洞察块使用等价占位策略"
      whitespace_balance:
        - "上下留白差阈值：每张卡片内'图上留白'与'图下留白'差值≤24px"
        - "图区占比下限：图表容器高度占卡片可用高度 70%–82%"
        - "短文案对齐策略：使用 justify-between 或等效占位，标题区/图区/结论区垂直均匀分布"
        - "左右一致性：两张并排卡使用同一垂直节奏策略（同类 padding、同类对齐）"
      bottom_card:
        - "底部卡同高：洞察/提示框显式同高（同 h-* 或 min-h-* + flex-1），禁止内容自适应导致左右不一致"
        - "高度差门限：差值≤8px；超过即判定不一致触发重排"
        - "补偿策略：短侧卡通过补充结构化要点或占位行补偿，不得保留裸露底部留白"

  # ──────────────────────────────────────────────────────────
  # 1.4 全宽重点布局 (full-width)
  # ──────────────────────────────────────────────────────────
  full_width:
    name: 全宽重点布局
    template: |
      <div class="slide-container">
        <div class="hero-section">重点内容</div>
        <div class="supporting-content">支持内容</div>
      </div>
    constraints:
      - "主图语义锚点：全宽趋势页主图必须带标题或口径短注（时间范围/单位其一）"
      - "KPI 卡字段最小集：指标名+时间点+数值+对比基线/差值 四项中至少三项"
      - "卡片解释性下限：'上行/基准/谨慎'类场景卡至少2张补充'相对基线变化(Δ)'或'业务含义短句'"
      - "增量信息原则：KPI 卡不得与'结论/原因/建议'三段完全重复，需至少1项新增可验证信息"
      - "满宽填充率 ≥ 86%"
      - "下半区预算区间：洞察卡+KPI 列总高度占主内容区可用高度 44%–52%"
      - "长文案防溢出：声明 overflow-auto 或等效行数裁剪策略"
      - "列间高度联动：底部左洞察卡与右 KPI 栈满足同一行高预算"
      - "KPI 最小可读高度：单卡 ≥ 64px，正文 ≥ 2 行可见"
      - "总和预算公式：top_section_h + bottom_section_h + main_gap + main_py <= main_available_h"

  # ──────────────────────────────────────────────────────────
  # 1.5 混合布局 (hybrid)
  # ──────────────────────────────────────────────────────────
  hybrid:
    name: 混合布局
    template: |
      <div class="slide-container">
        <div class="grid grid-cols-3 gap-6">
          <div class="col-span-2">
            <div class="main-chart">主图表区域</div>
            <div class="supporting-charts grid grid-cols-2 gap-4 mt-4">
              <div class="mini-chart">辅助图表1</div>
              <div class="mini-chart">辅助图表2</div>
            </div>
          </div>
          <div class="insight-stack">
            <div class="insight-card">洞察1</div>
            <div class="insight-card">洞察2</div>
            <div class="insight-card">洞察3</div>
          </div>
        </div>
      </div>

  # ──────────────────────────────────────────────────────────
  # 1.6 流程布局 (process)
  # ──────────────────────────────────────────────────────────
  process:
    name: 流程布局
    template: |
      <div class="slide-container">
        <div class="process-header">
          <h2>流程标题</h2>
          <p>流程描述</p>
        </div>
        <div class="process-flow flex justify-between items-center mt-8">
          <div class="process-step">步骤1</div>
          <div class="process-arrow">→</div>
          <div class="process-step">步骤2</div>
          <div class="process-arrow">→</div>
          <div class="process-step">步骤3</div>
          <div class="process-arrow">→</div>
          <div class="process-step">步骤4</div>
        </div>
        <div class="process-details grid grid-cols-4 gap-4 mt-8">
          <div class="step-detail">步骤1详情</div>
          <div class="step-detail">步骤2详情</div>
          <div class="step-detail">步骤3详情</div>
          <div class="step-detail">步骤4详情</div>
        </div>
      </div>
    constraints:
      - "步骤详情密度下限：每卡至少3条结构化信息（建议为'结论/错配点/建议'）"
      - "单卡文本下限：正文（不含步骤标题）每卡 ≥ 72 中文字符等价"
      - "步骤卡填充率 ≥ 78%"
      - "详情区占比：process-details 占主内容区可用高度 62%–76%"
      - "语义图标一致：步骤标题与详情中关键标签沿用同一图标语义体系"
      - "流程图标最小权重：process-flow 图标 ≥ text-xl，图标行高度 ≥ 120px"
      - "卡片留白上限：可视底部留白 ≤ 卡片高度 22%"
      - "图标列中心对齐：process-flow 4个图标中心与 process-details 4张卡片水平中心偏差 ≤ 8px"
      - "留白计算口径：card_fill_rate = content_h / card_inner_h >= 0.78 且 bottom_whitespace_ratio = bottom_blank_h / card_inner_h <= 0.22"

  # ──────────────────────────────────────────────────────────
  # 1.7 仪表板布局 (dashboard)
  # ──────────────────────────────────────────────────────────
  dashboard:
    name: 仪表板布局
    template: |
      <div class="slide-container">
        <div class="dashboard-header">
          <h2>仪表板标题</h2>
          <div class="dashboard-controls">筛选器、时间范围等</div>
        </div>
        <div class="dashboard-grid grid grid-cols-4 gap-4 mt-6">
          <div class="kpi-card">KPI指标1</div>
          <div class="kpi-card">KPI指标2</div>
          <div class="kpi-card">KPI指标3</div>
          <div class="kpi-card">KPI指标4</div>
        </div>
        <div class="dashboard-main grid grid-cols-3 gap-6 mt-6">
          <div class="main-chart col-span-2">主趋势图表</div>
          <div class="breakdown-chart">细分图表</div>
        </div>
        <div class="dashboard-bottom grid grid-cols-2 gap-6 mt-6">
          <div class="detail-table">详细数据表</div>
          <div class="alert-panel">告警面板</div>
        </div>
      </div>

  # ──────────────────────────────────────────────────────────
  # 1.8 里程碑时间线布局 (milestone-timeline)
  # ──────────────────────────────────────────────────────────
  milestone_timeline:
    name: 里程碑时间线布局
    template: |
      <div class="slide-container">
        <div class="timeline-shell relative h-[520px] card p-4 overflow-hidden">
          <!-- 阶段分隔线 -->
          <div class="phase-divider absolute inset-y-[12%] left-[50%] border-r-2 border-dashed border-slate-300 z-0"></div>
          <!-- 阶段标签 -->
          <div class="phase-label absolute top-3 left-[20%] text-xs font-semibold text-slate-500 tracking-wide uppercase">Phase 1</div>
          <div class="phase-label absolute top-3 left-[70%] text-xs font-semibold text-slate-500 tracking-wide uppercase">Phase 2</div>
          <!-- 时间轴 (水平居中) -->
          <div class="timeline-axis absolute left-[5%] right-[5%] top-1/2 -translate-y-1/2 h-[4px] bg-gradient-to-r from-slate-300 via-slate-200 to-slate-300 rounded-full z-10"></div>
          <!-- 年份标签 — 锚定在轴线上，absolute + top-1/2 -->
          <span class="year-label absolute top-1/2 -translate-y-[calc(50%+18px)] text-[11px] font-bold text-slate-600 z-20" style="left:10%">2020</span>
          <span class="year-label absolute top-1/2 -translate-y-[calc(50%+18px)] text-[11px] font-bold text-slate-600 z-20" style="left:28%">2021</span>
          <span class="year-label absolute top-1/2 -translate-y-[calc(50%+18px)] text-[11px] font-bold text-slate-600 z-20" style="left:46%">2022</span>
          <span class="year-label absolute top-1/2 -translate-y-[calc(50%+18px)] text-[11px] font-bold text-slate-600 z-20" style="left:64%">2023</span>
          <span class="year-label absolute top-1/2 -translate-y-[calc(50%+18px)] text-[11px] font-bold text-slate-600 z-20" style="left:82%">2024</span>
          <!-- 事件圆点 — 锚在轴线上 -->
          <div class="event-dot absolute top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-brand-primary border-2 border-white shadow z-20" style="left:10%"></div>
          <div class="event-dot absolute top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-brand-primary border-2 border-white shadow z-20" style="left:28%"></div>
          <div class="event-dot absolute top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-brand-primary border-2 border-white shadow z-20" style="left:46%"></div>
          <div class="event-dot absolute top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-brand-primary border-2 border-white shadow z-20" style="left:64%"></div>
          <div class="event-dot absolute top-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-brand-primary border-2 border-white shadow z-20" style="left:82%"></div>
          <!-- ━━ 连接线（必须保留！每个 event-dot 必须有一条垂直线连到对应卡片） ━━ -->
          <div class="connection-line absolute w-[2px] h-[60px] bg-slate-300 z-10" style="left:calc(10% + 5px); top:calc(50% - 66px)"></div>
          <div class="connection-line absolute w-[2px] h-[60px] bg-slate-300 z-10" style="left:calc(28% + 5px); top:calc(50% + 8px)"></div>
          <div class="connection-line absolute w-[2px] h-[60px] bg-slate-300 z-10" style="left:calc(46% + 5px); top:calc(50% - 66px)"></div>
          <div class="connection-line absolute w-[2px] h-[60px] bg-slate-300 z-10" style="left:calc(64% + 5px); top:calc(50% + 8px)"></div>
          <div class="connection-line absolute w-[2px] h-[60px] bg-slate-300 z-10" style="left:calc(82% + 5px); top:calc(50% - 66px)"></div>
          <!-- 事件卡片 — 上下交错 -->
          <article class="event-card absolute w-[160px] p-3 rounded-lg shadow-sm bg-white border border-slate-100 text-xs z-20" style="left:calc(10% - 74px); bottom:calc(50% + 72px)">
            <div class="font-semibold text-brand-primary mb-1">事件标题</div>
            <div class="text-slate-500 leading-relaxed">事件描述文本（≥28字符）</div>
          </article>
          <article class="event-card absolute w-[160px] p-3 rounded-lg shadow-sm bg-white border border-slate-100 text-xs z-20" style="left:calc(28% - 74px); top:calc(50% + 72px)">
            <div class="font-semibold text-brand-primary mb-1">事件标题</div>
            <div class="text-slate-500 leading-relaxed">事件描述文本（≥28字符）</div>
          </article>
          <article class="event-card absolute w-[160px] p-3 rounded-lg shadow-sm bg-white border border-slate-100 text-xs z-20" style="left:calc(46% - 74px); bottom:calc(50% + 72px)">
            <div class="font-semibold text-brand-primary mb-1">事件标题</div>
            <div class="text-slate-500 leading-relaxed">事件描述文本（≥28字符）</div>
          </article>
          <article class="event-card absolute w-[160px] p-3 rounded-lg shadow-sm bg-white border border-slate-100 text-xs z-20" style="left:calc(64% - 74px); top:calc(50% + 72px)">
            <div class="font-semibold text-brand-primary mb-1">事件标题</div>
            <div class="text-slate-500 leading-relaxed">事件描述文本（≥28字符）</div>
          </article>
          <article class="event-card absolute w-[160px] p-3 rounded-lg shadow-sm bg-white border border-slate-100 text-xs z-20" style="left:calc(82% - 74px); bottom:calc(50% + 72px)">
            <div class="font-semibold text-brand-primary mb-1">事件标题</div>
            <div class="text-slate-500 leading-relaxed">事件描述文本（≥28字符）</div>
          </article>
        </div>
      </div>
    constraints:
      - "适用门槛：年度事件演进+里程碑叙事 且事件点 ≥ 6 时优先使用"
      - "轴向锚点完整：event-dot + year-label + event-card + connection-line 四要素缺一不可"
      - "上下交错节奏：相邻事件卡 top/bottom 交错，连续同侧不超2张"
      - "横向防碰撞：相邻事件卡水平重叠 ≤ 16px；超限减小卡宽或增大间距"
      - "阶段分区显式化：两阶段及以上须提供 phase 分隔线或背景分区 + 阶段标签"

  # ──────────────────────────────────────────────────────────
  # Radar + KPI 专项约束（适用于 hybrid 布局主图为雷达图时）
  # ──────────────────────────────────────────────────────────
  radar_kpi:
    applies_to: "hybrid 且主图为雷达图"
    constraints:
      - "左侧图区占比：chart-wrap 高度占左卡可用高度 68%–80%"
      - "右侧结构化密度：至少3个结构化区块（结论/原因/建议），每块 ≥ 1条可执行/验证陈述"
      - "右栏填充策略：整体内容占用高度 ≥ 82%，文案不足时优先补充'量化快照卡'"
      - "垂直节奏一致：左卡与右卡使用一致的分区（标题/主体/底部信息）"

  # ──────────────────────────────────────────────────────────
  # 图标一致性约束（跨布局通用）
  # ──────────────────────────────────────────────────────────
  icon_consistency:
    constraints:
      - "列表图标语义化：含结论/原因/建议列表页采用同一图标体系（FontAwesome）与同级视觉权重"
      - "跨页风格统一：图标风格（线性/实心）、尺寸（text-sm ~ text-base）、主色使用需一致"
      - "优先作用域：Hybrid/Bubble+Narrative/Radar+KPI 页右栏三段式优先接入图标语义"

  # ──────────────────────────────────────────────────────────
  # Gantt 路线图留白平衡
  # ──────────────────────────────────────────────────────────
  gantt:
    constraints:
      - "左侧排程占比：甘特容器占左卡可用高度 72%–84%"
      - "右侧行动填充：行动卡总占用高度 ≥ 85%，建议 flex-1 共享高度"
      - "卡片密度分级：风险提示卡为低权重（可 shrink-0），不挤占三条主行动卡"
      - "左右平衡阈值：左右列可视留白率差值 ≤ 10%"
      - "标签区宽度上限：yAxis 标签区宽度 ≤ 图容器宽度 18%；超限缩写标签或降低 grid.left"

# ╔══════════════════════════════════════════════════════════╗
# ║  2. 布局选择指南                                        ║
# ╚══════════════════════════════════════════════════════════╝

selection_guide:
  - { content_type: 单点洞察, layout: data-chart, scenario: "深度分析单个数据点" }
  - { content_type: 对比分析, layout: side-by-side, scenario: "A/B测试、竞品对比" }
  - { content_type: 全景展示, layout: full-width, scenario: "战略愿景、整体概况" }
  - { content_type: 复杂分析, layout: hybrid, scenario: "多层次数据展示" }
  - { content_type: 流程说明, layout: process, scenario: "工作流、时间线展示" }
  - { content_type: 里程碑叙事, layout: milestone-timeline, scenario: "年度事件演进、阶段转折、关键节点" }
  - { content_type: 监控报告, layout: dashboard, scenario: "实时监控、KPI跟踪" }
  - { content_type: 综合数据视图, layout: dashboard_grid, scenario: "复杂多维数据、KPI+趋势组合分析 (New Standard)" }

# ╔══════════════════════════════════════════════════════════╗
# ║  3. 版式去重规则                                        ║
# ╚══════════════════════════════════════════════════════════╝

dedup_rules:
  - "连续页禁止同构：任意相邻两页不得使用同一主布局类型"
  - "主布局判定口径：按主内容区占比最大的布局模块判定，不以局部卡片差异视为不同布局"
  - "冲突时优先级：第二页必须切换为视觉等价替代（如 data-chart → hybrid / dashboard）"
  - "封面与尾页例外：封面与尾页不参与连续页同构校验"

# ╔══════════════════════════════════════════════════════════╗
# ║  4. Notion 风格高保真页面骨架                           ║
# ╚══════════════════════════════════════════════════════════╝

notion_skeleton: |
  <div class="slide-container w-[1280px] h-[720px] bg-white">
    <header class="px-12 pt-10 pb-6 border-b border-slate-200">
      <p class="text-xs tracking-wider text-slate-500 uppercase">Section Eyebrow</p>
      <div class="flex items-end justify-between mt-2">
        <h1 class="text-5xl font-bold text-[var(--brand-primary)]">主标题（中文）</h1>
        <div class="text-right">
          <p class="text-4xl font-light text-[var(--brand-secondary)]">English Title</p>
          <p class="text-sm text-slate-400">Subtitle / Metric Unit</p>
        </div>
      </div>
    </header>
    <main class="px-12 py-6 grid grid-cols-12 gap-6 min-h-0">
      <section class="col-span-7 card p-4 min-h-0">主图表区域</section>
      <aside class="col-span-5 flex flex-col gap-4 min-h-0">洞察卡片与关键数字</aside>
    </main>
    <footer class="px-12 py-4 border-t border-slate-200 flex items-center justify-between text-sm text-slate-500">
      <span>关键结论/口径说明</span>
      <span>页码 / 数据来源</span>
    </footer>
  </div>

  # ──────────────────────────────────────────────────────────
  # 1.5 支柱型布局 (pillar) - 适用于 Executive Summary / Key Takeaways
  # ──────────────────────────────────────────────────────────
  pillar:
    name: 支柱型布局 (Floating Pillars)
    template: |
      <div class="slide-container">
        <div class="header">...</div>
        <div class="content-area grid grid-cols-3 gap-8 px-12 pt-12 pb-16 items-start">
          <!-- Pillar 1 -->
          <div class="card-float h-full flex flex-col items-center text-center">
             <div class="icon-circle">...</div>
             <h2>Title</h2>
             <ul>...</ul>
             <div class="impact-badge">...</div>
          </div>
          <!-- Repeat for Pillar 2 & 3 -->
        </div>
        <div class="footer">...</div>
      </div>
    constraints:
      - "适用场景：Executive Summary, 核心支柱展示, 战略概览"
      - "视觉特征：无边框悬浮卡片 (.card-float)，大图标居中，强调简洁有力"
      - "排版平衡：三列等宽，高度自然对齐，避免某列过长"

  # ──────────────────────────────────────────────────────────
  # 1.6 流程型布局 (process) - 适用于 Timeline / Evolution
  # ──────────────────────────────────────────────────────────
  process:
    name: 流程型布局 (Horizontal Process)
    template: |
      <div class="slide-container">
        <div class="header">...</div>
        <div class="content-area flex flex-col justify-center gap-6">
          <div class="step-process-container mb-2">
            <!-- Steps -->
            <div class="step-item group">
               <div class="step-circle">Icon</div>
               <h3>Date/Stage</h3>
               <p>Desc</p>
            </div>
          </div>
          <div class="card-float summary">...</div>
        </div>
      </div>
    constraints:
      - "适用场景：时间线, 演变过程, 逻辑步骤 (Step 1-2-3)"
      - "交互设计：使用 group-hover 增加微交互"
      - "结构要求：必须包含 .step-process-container 和 .step-item"

  # ──────────────────────────────────────────────────────────
  # 1.7 对比型布局 (comparison) - 适用于 Competitor Analysis
  # ──────────────────────────────────────────────────────────
  comparison:
    name: 对比型布局 (Vertical Columns)
    template: |
      <div class="slide-container">
        <div class="header">...</div>
        <div class="content-area grid grid-cols-3 gap-2 h-full">
           <!-- Column 1 -->
           <div class="flex flex-col bg-gray-50 border-t-4 border-gray-800 h-full p-3">
              <div class="header-block">Icon + Title + Tag</div>
              <ul class="flex-1 list-none space-y-2">
                 <li class="bg-white p-2 shadow-sm">Item</li>
              </ul>
           </div>
           <!-- Repeat for Column 2 & 3 -->
        </div>
      </div>
    constraints:
      - "适用场景：竞品分析 (x86 vs ARM), 方案对比 (Option A vs B)"
      - "视觉特征：垂直长条卡片，顶部明显色彩区分 (border-t-4)"
      - "内容结构：必须包含 Pros/Cons/Focus 等结构化列表"

# ╔══════════════════════════════════════════════════════════╗
# ║  5. 页面级约束                                          ║
# ╚══════════════════════════════════════════════════════════╝

page_constraints:

  # ---- 5.1 版面平衡硬约束 ----
  layout_balance:
    - "左右列占用率：主图区列与叙事列的内容占用高度均需 ≥ 85%"
    - "留白差控制：左右列可视留白率差值不得超过 10%"
    - rule: |
        触发失败时优先执行：
        ① 提升主图容器高度（建议 h-[400px] ~ h-[460px]）
        ② 或增加右栏结构化条目（数字化 bullet / 快照卡）
        禁止仅通过增大外边距"制造平衡"

  # ---- 5.2 垂直预算与页脚安全区 ----
  vertical_budget:
    - "单页高度预算：header + main + footer <= slide_height，禁止通过 overflow: visible 跨越页脚边界"
    - "主区安全上限：1280×720 画布中 main 可用高度不超过 540px"
    - "页脚安全区：主内容区底部保留至少 8px 安全间距"
    - "内层高度约束：main 内部容器高度不得超过 main 的内容盒高度（扣除 py 与边框后）"

  # ---- 5.3 内容溢出处理策略 ----
  overflow_handling:
    - "卡片溢出策略必选：长文案卡片必须显式声明 overflow-auto 或执行文案压缩"
    - "正文行数上限：Bubble + Narrative 右栏每卡默认 ≤ 5 行正文"
    - "注释与快照预算：左栏注释区 + 快照区总高度 ≤ 可用高度 22%"
    - rule: |
        超限降级顺序：
        ① 先压缩文案（减少冗余修饰词，保留数字与结论）
        ② 再减少辅助块高度（快照/注释）
        ③ 最后下调图表容器高度（保持图可读性下限）
