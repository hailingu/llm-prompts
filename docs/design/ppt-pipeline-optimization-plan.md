# PPT Pipeline é•¿æ•ˆä¼˜åŒ–æ–¹æ¡ˆ

> **ç­–ç•¥ä»£å·**ï¼šå¢é‡å¢å¼ºï¼ŒåŒè½¨å¹¶å­˜  
> **ç‰ˆæœ¬**ï¼šv1.0  
> **æ—¥æœŸ**ï¼š2026-02-11  
> **çŠ¶æ€**ï¼šDraft

---

## ç›®å½•

- [1. èƒŒæ™¯ä¸é—®é¢˜](#1-èƒŒæ™¯ä¸é—®é¢˜)
- [2. ç«å“å·®è·åˆ†æ](#2-ç«å“å·®è·åˆ†æ)
- [3. æ ¹å› è¯Šæ–­](#3-æ ¹å› è¯Šæ–­)
- [4. æˆ˜ç•¥æ–¹å‘](#4-æˆ˜ç•¥æ–¹å‘)
- [5. æ¶æ„è®¾è®¡](#5-æ¶æ„è®¾è®¡)
- [6. å®æ–½è·¯çº¿å›¾](#6-å®æ–½è·¯çº¿å›¾)
- [7. KPI ä½“ç³»](#7-kpi-ä½“ç³»)
- [8. é£é™©ä¸ç¼“è§£](#8-é£é™©ä¸ç¼“è§£)
- [é™„å½• Aï¼šSchema v2 å­—æ®µå®šä¹‰](#é™„å½•-a-schema-v2-å­—æ®µå®šä¹‰)
- [é™„å½• Bï¼šåŒºåŸŸæ¸²æŸ“å™¨æ¸…å•](#é™„å½•-b-åŒºåŸŸæ¸²æŸ“å™¨æ¸…å•)

---

## 1. èƒŒæ™¯ä¸é—®é¢˜

### 1.1 å½“å‰ç®¡çº¿æ¶æ„

PPT ç”Ÿæˆç®¡çº¿ç”± **4 ä¸ª Agent + 4 ä¸ª Skill + 1 ä¸ª Schema + 1 ä¸ªæ¸²æŸ“å™¨** ç»„æˆï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Creative Director (CD)                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ Content Planner  â”‚â”€â”€â”€â–¶â”‚ Visual Designer  â”‚                    â”‚
â”‚  â”‚     (CP)         â”‚    â”‚     (VD)         â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚           â”‚                       â”‚                              â”‚
â”‚           â–¼                       â–¼                              â”‚
â”‚    slides.md              design_spec.json                       â”‚
â”‚    slides_semantic.json                                          â”‚
â”‚           â”‚                       â”‚                              â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                       â–¼                                          â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚              â”‚ PPT Specialist â”‚                                  â”‚
â”‚              â”‚     (PS)       â”‚                                  â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚                       â–¼                                          â”‚
â”‚              generate_pptx.py                                    â”‚
â”‚              (~3100 lines)                                       â”‚
â”‚                       â–¼                                          â”‚
â”‚                   .pptx æ–‡ä»¶                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®æ–‡ä»¶æ¸…å•**ï¼š

| æ–‡ä»¶ | ç”¨é€” | è¡Œæ•° |
|------|------|------|
| `agents/ppt-creative-director.agent.md` | ç¼–æ’åè°ƒ | 364 |
| `agents/ppt-content-planner.agent.md` | å†…å®¹è§„åˆ’ï¼Œäº§å‡º slides.md + slides_semantic.json | 380 |
| `agents/ppt-visual-designer.agent.md` | è§†è§‰è®¾è®¡ï¼Œäº§å‡º design_spec.json | 656 |
| `agents/ppt-specialist.agent.md` | æ¸²æŸ“æ‰§è¡Œ | 561 |
| `skills/ppt-content-planning/README.md` | å†…å®¹è§„åˆ’æŠ€èƒ½è§„èŒƒ | 534 |
| `skills/ppt-design-system/README.md` | MD3 è®¾è®¡ç³»ç»Ÿ | 648 |
| `skills/ppt-visual-taxonomy/README.md` | å¯è§†åŒ–åˆ†ç±»æ³•ï¼ˆ24 ç§ç±»å‹ï¼‰ | 283 |
| `skills/ppt-generator/README.md` | æ¸²æŸ“æ¶æ„æ–‡æ¡£ | 1464 |
| `standards/slides-render-schema.json` | Schema v1 æ¥å£å¥‘çº¦ | 185 |
| `.github/skills/ppt-generator/bin/generate_pptx.py` | å•ä½“æ¸²æŸ“å™¨ | ~3100 |

### 1.2 å·²å®Œæˆçš„è¿­ä»£

ç»è¿‡ v1 â†’ v8 å…± 8 è½®è¿­ä»£ï¼Œå·²å®ç°ï¼š

- Material Design 3 é…è‰²ä½“ç³»ï¼ˆ31 è‰²å½© tokenï¼‰
- 12 æ ç½‘æ ¼å¸ƒå±€ï¼ˆ13.333" Ã— 7.5"ï¼‰
- 9 ç§é£æ ¼é¢„è®¾ï¼ˆBCGã€McKinseyã€Bain ç­‰ï¼‰
- KPI æ¯”ä¾‹æ¡ï¼ˆproportion barsï¼‰
- æ•°æ®ç¨€ç–é¡µæ´å¯Ÿæ¡ï¼ˆinsight stripï¼‰
- ç©ºå›¾è¡¨å…œåº•ï¼ˆplaceholder + æç¤ºæ–‡å­—ï¼‰
- å°åˆ—è¡¨å‚ç›´å±…ä¸­
- å¯¹æ¯”é¡µæ°´å¹³æŸ±çŠ¶å›¾å˜ä½“

### 1.3 æ ¸å¿ƒé—®é¢˜

**åŒä¸€ä»½ `slides.md` è¾“å…¥ï¼Œç«å“å·¥å…·ï¼ˆå¦‚ Google NotebookLMï¼‰äº§å‡ºçš„ PPT åœ¨è§†è§‰è´¨é‡å’Œä¿¡æ¯å¯†åº¦ä¸Šè¿œè¶…æˆ‘ä»¬çš„è¾“å‡º**ã€‚

å…·ä½“è¡¨ç°ï¼š

| ç»´åº¦ | ç«å“è¡¨ç° | æˆ‘ä»¬çš„ç°çŠ¶ |
|------|----------|------------|
| é¡µæ•° | 12 é¡µï¼ˆé«˜å¯†åº¦ï¼‰ | 23 é¡µï¼ˆä¿¡æ¯åˆ†æ•£ï¼‰ |
| æ ‡é¢˜ | æ–­è¨€å¼æ ‡é¢˜ï¼ˆassertion titleï¼‰ | æ ‡ç­¾å¼æ ‡é¢˜ï¼ˆlabel titleï¼‰ |
| å›¾è¡¨ | åŸç”ŸçŸ¢é‡å›¾ + è¡¨æ ¼å¤åˆ | matplotlib ä½å›¾åµŒå…¥ |
| å¸ƒå±€ | å¤šç»„ä»¶å¤åˆæ’ç‰ˆ | å•å…ƒç´ /é¡µ |
| å½¢çŠ¶ | åŸç”Ÿ shapes ç»˜åˆ¶æ¶æ„å›¾ | æ–‡å­—å ä½ç¬¦æè¿° |
| å›¾æ ‡ | ä¸°å¯Œçš„ icon ä½“ç³» | æ—  |

---

## 2. ç«å“å·®è·åˆ†æ

### 2.1 äº”å¤§å·®è·çŸ©é˜µ

| # | å·®è·ç»´åº¦ | ä¸¥é‡åº¦ | å½±å“é¢ | å½“å‰ | ç›®æ ‡ |
|---|----------|--------|--------|------|------|
| G1 | æ–­è¨€å¼æ ‡é¢˜ vs æ ‡ç­¾å¼æ ‡é¢˜ | ğŸ”´ | å…¨éƒ¨é¡µé¢ | "å‚¨èƒ½æŠ€æœ¯è·¯çº¿å¯¹æ¯”" | "EV å¿«å……åœ¨æˆæœ¬å¯†åº¦ä¸Šé¢†å…ˆ 40%" |
| G2 | å¤šç»„ä»¶å¤åˆ vs å•å…ƒç´ /é¡µ | ğŸ”´ | å†…å®¹é¡µ | å›¾/è¡¨/æ–‡å­—åˆ†é¡µ | å›¾+è¡¨+è¦ç‚¹åŒé¡µ |
| G3 | åŸç”Ÿå›¾è¡¨ vs matplotlib ä½å›¾ | ğŸ”´ | æ•°æ®é¡µ | PNG åµŒå…¥ | python-pptx åŸç”Ÿå›¾è¡¨ |
| G4 | shapes æ¸²æŸ“ vs æ–‡å­—å ä½ | ğŸŸ¡ | æ¶æ„é¡µ | "è¯·å‚è€ƒæµç¨‹å›¾" | AutoShape ç®­å¤´/æ¡† |
| G5 | ä¿¡æ¯å¯†åº¦ï¼ˆå‹ç¼©æ¯”ï¼‰ | ğŸ”´ | å…¨å±€ | 0.92ï¼ˆå‡ ä¹ 1:1ï¼‰ | â‰¤0.4 |

### 2.2 ä¿¡æ¯å¯†åº¦å¯¹æ¯”

```
ç«å“ä¿¡æ¯å¯†åº¦æ¨¡å‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ ‡é¢˜ï¼šæ–­è¨€ï¼ˆè‡ªå¸¦ insightï¼‰                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚  å·¦åŒºåŸŸï¼šå›¾è¡¨/è¡¨æ ¼ â”‚  å³åŒºåŸŸï¼šå…³é”®å‘ç°/è¦ç‚¹    â”‚  â”‚
â”‚ â”‚  ï¼ˆåŸç”ŸçŸ¢é‡ï¼‰     â”‚  ï¼ˆç»“æ„åŒ– bulletsï¼‰       â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  åº•éƒ¨ï¼šæ•°æ®æ¥æº / callout                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æˆ‘ä»¬çš„ä¿¡æ¯å¯†åº¦æ¨¡å‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ ‡é¢˜ï¼šæ ‡ç­¾ï¼ˆæ—  insightï¼‰                         â”‚
â”‚                                                   â”‚
â”‚           å¤§é¢ç§¯ matplotlib PNG                    â”‚
â”‚           æˆ– 3-5 æ¡ bullets                       â”‚
â”‚                                                   â”‚
â”‚                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. æ ¹å› è¯Šæ–­

### 3.1 æ ¹å› ä¸€ï¼šç®¡çº¿ä¸­ç¼ºå°‘"è§†è§‰æ€è€ƒè€…"

**ç°è±¡**ï¼šç«å“çš„å›¾è¡¨/å›¾æ ‡æ›´ä¸°å¯Œã€æ›´åˆ‡é¢˜ã€‚

**æ ¹å› **ï¼š
- CPï¼ˆContent Plannerï¼‰è´Ÿè´£å†…å®¹ä½†ä¸æ€è€ƒè§†è§‰ï¼›VDï¼ˆVisual Designerï¼‰è´Ÿè´£æ ·å¼ä½†ä¸ç†è§£å†…å®¹ã€‚"ä»€ä¹ˆå†…å®¹ç”¨ä»€ä¹ˆæ–¹å¼å‘ˆç°"è¿™ä¸ªæ ¸å¿ƒå†³ç­–**æ— äººè´Ÿè´£**ã€‚
- CP äº§å‡ºçš„ `visual` å­—æ®µä»…æ˜¯ `{"type": "bar_chart", "placeholder_data": {...}}`â€”â€”ä¸€ç§æœºæ¢°æ˜ å°„ï¼Œè€ŒéåŸºäºè®¤çŸ¥è´Ÿè·çš„å¯è§†åŒ–é€‰æ‹©ã€‚
- 24 ç§å¯è§†åŒ–ç±»å‹å®šä¹‰åœ¨ `ppt-visual-taxonomy` ä¸­ï¼Œä½†æ—  Agent å…·å¤‡"ç†è§£å†…å®¹è¯­ä¹‰ â†’ é€‰æ‹©æœ€ä½³å¯è§†åŒ– â†’ è®¾è®¡å¤åˆå±•ç¤º"çš„ç«¯åˆ°ç«¯èƒ½åŠ›ã€‚

**æœ¬è´¨**ï¼šå†…å®¹ç†è§£å’Œè§†è§‰å†³ç­–è¢«äººä¸ºå‰²è£‚ï¼Œç®¡çº¿ä¸­æ²¡æœ‰äººåœ¨åš**å±•ç¤ºè®¾è®¡**ï¼ˆExhibit Designï¼‰ã€‚

### 3.2 æ ¹å› äºŒï¼šSchema çš„ç±»å‹æšä¸¾é˜»æ­¢äº†å¤åˆå¸ƒå±€

**ç°è±¡**ï¼šç«å“ä¸€é¡µæ”¾ å›¾+è¡¨+è¦ç‚¹ï¼Œæˆ‘ä»¬ä¸€é¡µåªæ”¾ä¸€ç§å…ƒç´ ã€‚

**æ ¹å› **ï¼š
- Schema v1 çš„ `slide_type` æ˜¯ä¸€ä¸ªæšä¸¾å€¼ï¼ˆ13 ç§ï¼‰ï¼Œæ¯ç§ç±»å‹ç»‘å®šä¸€ä¸ªå›ºå®šå¸ƒå±€å‡½æ•°ã€‚
- æ¸²æŸ“å™¨é€šè¿‡ `RENDERERS[slide_type]` åˆ†å‘â€”â€”è¿™æ„å‘³ç€ä¸€é¡µåªèƒ½å±äºä¸€ç§ç±»å‹ï¼Œæ— æ³•ç»„åˆã€‚
- `components` å­—æ®µè™½ç„¶æ”¯æŒå¤šç§ç»„ä»¶å…±å­˜ï¼Œä½†å®é™…æ¸²æŸ“é€»è¾‘å¿½ç•¥äº†éå½“å‰ `slide_type` å…³è”çš„ç»„ä»¶ã€‚

**å¯¹æ¯”**ï¼šç«å“çš„æ¸²æŸ“æ¨¡å‹æ˜¯**åŒºåŸŸç»„åˆ**ï¼ˆRegion Compositionï¼‰â€”â€”é¡µé¢è¢«åˆ†ä¸ºè‹¥å¹²åŒºåŸŸï¼Œæ¯ä¸ªåŒºåŸŸç‹¬ç«‹æ¸²æŸ“ä¸åŒç»„ä»¶ã€‚æˆ‘ä»¬çš„æ¨¡å‹æ˜¯**ç±»å‹æ´¾å‘**ï¼ˆType Dispatchï¼‰â€”â€”`slide_type` å†³å®šä¸€åˆ‡ã€‚

```
ç±»å‹æ´¾å‘ï¼ˆå½“å‰ï¼‰ï¼š               åŒºåŸŸç»„åˆï¼ˆç›®æ ‡ï¼‰ï¼š
slide_type = "data-heavy"       layout_intent:
       â”‚                          regions:
       â–¼                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
RENDERERS["data-heavy"]()        â”‚ top: kpi_row          â”‚
       â”‚                          â”‚ main: chart + table   â”‚
       â–¼                          â”‚ side: callout_stack   â”‚
  å›ºå®šå¸ƒå±€                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 æ ¹å› ä¸‰ï¼šCP æ˜¯"æŠ„å†™å‘˜"è€Œé"ç¼–è¾‘"

**ç°è±¡**ï¼šç«å“ç”¨æ›´å°‘çš„è¾“å…¥ä¿¡æ¯äº§å‡ºæ›´ä¸°å¯Œçš„å†…å®¹ã€‚

**æ ¹å› **ï¼š
- CP çš„ MO-6 è‡ªæ£€è§„åˆ™ï¼ˆ"æ•°æ®å¿…é¡»æœ‰æ¥æºï¼Œä¸æé€ "ï¼‰è¢«**è¿‡åº¦è§£è¯»**ä¸º"ä¸åšä»»ä½•å†…å®¹åˆæˆ"ã€‚
- CP æ¥æ”¶åˆ°ä¸°å¯Œçš„æºæ–‡æ¡£ï¼ˆ`slides.md`ï¼‰ï¼Œä½†ä»…åš 1:1 æ®µè½æ¬è¿â€”â€”æ¯ä¸ª heading å˜ä¸€é¡µ slideï¼Œæ¯ä¸ª bullet åŸå°ä¸åŠ¨ã€‚è¿™å¯¼è‡´å‹ç¼©æ¯”æ¥è¿‘ 1.0ã€‚
- ç«å“çš„åšæ³•æ˜¯**å†…å®¹ç¼–è¾‘**ï¼šåˆå¹¶ç›¸ä¼¼æ®µè½ã€æç‚¼æ–­è¨€ã€è¡¥å……æ¨è®ºã€äº¤å‰å¼•ç”¨æ•°æ®â€”â€”æœ€ç»ˆ 25 èŠ‚å†…å®¹æµ“ç¼©ä¸º 12 é¡µé«˜å¯†åº¦å±•ç¤ºã€‚

**ç±»æ¯”**ï¼š

| è§’è‰² | CPï¼ˆå½“å‰ï¼‰ | ç«å“è¡Œä¸º |
|------|-----------|----------|
| å®šä½ | æŠ„å†™å‘˜ / Transcriber | ç¼–è¾‘ / Editor |
| è¾“å…¥â†’è¾“å‡º | 25 èŠ‚ â†’ 23 é¡µ | 25 èŠ‚ â†’ 12 é¡µ |
| æ ¸å¿ƒåŠ¨ä½œ | æ¬è¿ã€æ ¼å¼åŒ– | åˆå¹¶ã€æç‚¼ã€æ¨è®º |
| å‹ç¼©æ¯” | ~0.92 | ~0.4 |

### 3.4 ä¸€å¥è¯æ€»ç»“

> **å·®è·çš„æ ¹æºä¸æ˜¯"æˆ‘ä»¬çš„å·¥å…·å°‘"ï¼Œè€Œæ˜¯"æˆ‘ä»¬çš„ç®¡çº¿é‡Œæ²¡æœ‰äººåœ¨æ€è€ƒ"ã€‚**
>
> ç«å“èµ¢åœ¨**å†…å®¹ç¼–è¾‘èƒ½åŠ›**ï¼ˆåˆå¹¶æç‚¼ï¼‰å’Œ**å±•ç¤ºè®¾è®¡èƒ½åŠ›**ï¼ˆåŒºåŸŸå¤åˆï¼‰ï¼Œè€Œä¸ä»…æ˜¯æ¸²æŸ“æŠ€æœ¯ã€‚

---

## 4. æˆ˜ç•¥æ–¹å‘

### 4.1 æ ¸å¿ƒç­–ç•¥ï¼šå¢é‡å¢å¼ºï¼ŒåŒè½¨å¹¶å­˜

```
"ä¸æ›¿æ¢ï¼Œåªå¢å¼ºï¼›ä¸æ”¹ CPï¼ŒåŠ  EAï¼›v1 è‡ªåŠ¨é™çº§ï¼Œv2 æ¸è¿›å¢èƒ½ã€‚"
```

#### å…³é”®çº¦æŸ

1. **CP å¿…é¡»ä¿æŒä¸å˜**â€”â€”`slides.md` æ˜¯å¯è·¨å¹³å°èµ„äº§ï¼ˆå¯å–‚ç»™ç«å“å·¥å…·éªŒè¯æ•ˆæœï¼‰ï¼Œæ”¹æ‰ CP ç­‰äºå¤±å»è¿™ä¸ªèƒ½åŠ›ã€‚
2. **æ¸²æŸ“å™¨å¿…é¡»å‘åå…¼å®¹**â€”â€”v1 æ ¼å¼çš„ `slides_semantic.json` å§‹ç»ˆå¯æ­£å¸¸æ¸²æŸ“ã€‚
3. **æ¸è¿›å¢å¼º**â€”â€”Schema v2 æ–°å­—æ®µä¸ºå¯é€‰æ‰©å±•ï¼Œä¸ç ´åç°æœ‰æµç¨‹ã€‚

#### åŒè½¨æ¨¡å‹

```
          slides.md
              â”‚
              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Content Planner â”‚ â† ä¿æŒä¸å˜
    â”‚      (CP)        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    slides_semantic.json (v1)
             â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
     â”‚               â”‚
     â–¼               â–¼
  Track A          Track B
  (v1 ç›´é€š)       (v2 å¢å¼º)
     â”‚               â”‚
     â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚      â”‚ Exhibit Architectâ”‚ â† æ–°å¢ Agent
     â”‚      â”‚      (EA)        â”‚
     â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚               â”‚
     â”‚               â–¼
     â”‚      slides_semantic.json (v2)
     â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚      â”‚ + assertion æ–­è¨€æ ‡é¢˜  â”‚
     â”‚      â”‚ + insight  æ´å¯Ÿæç‚¼   â”‚
     â”‚      â”‚ + layout_intent åŒºåŸŸ  â”‚
     â”‚      â”‚ + é¡µé¢åˆå¹¶/å‹ç¼©       â”‚
     â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚               â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Renderer     â”‚ â† è‡ªåŠ¨æ£€æµ‹ v1/v2
    â”‚ generate_pptx  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
         .pptx æ–‡ä»¶
```

### 4.2 EAï¼ˆExhibit Architectï¼‰Agent å®šä½

| ç»´åº¦ | è¯´æ˜ |
|------|------|
| è¾“å…¥ | v1 `slides_semantic.json` + `slides.md`ï¼ˆåŸå§‹ç´ æï¼‰ |
| è¾“å‡º | v2 `slides_semantic.json`ï¼ˆå¢å¼ºç‰ˆï¼‰ |
| æ ¸å¿ƒèƒ½åŠ› | â‘  æ–­è¨€æç‚¼ â‘¡ é¡µé¢åˆå¹¶ â‘¢ å¯è§†åŒ–å‡çº§ â‘£ åŒºåŸŸå¸ƒå±€è®¾è®¡ |
| ä¸ CP å…³ç³» | CP äº§å‡º v1 â†’ EA å¢å¼ºä¸º v2ï¼ˆå¯é€‰ç¯èŠ‚ï¼Œè·³è¿‡åˆ™ç”¨ v1 ç›´é€šï¼‰ |
| è§¦å‘æ–¹å¼ | CD ç¼–æ’æ—¶å†³å®šæ˜¯å¦å¯ç”¨ EAï¼ˆé»˜è®¤å¯ç”¨ï¼‰ |

**EA åšä»€ä¹ˆ vs ä¸åšä»€ä¹ˆ**ï¼š

| EA åš | EA ä¸åš |
|-------|---------|
| ä» bullets ä¸­æç‚¼ assertion title | ä¿®æ”¹ slides.md |
| åˆå¹¶ç›¸ä¼¼ slideï¼ˆ25â†’15 é¡µï¼‰ | åˆ›é€ ä¸å­˜åœ¨çš„æ•°æ® |
| å°† slide_type + components è½¬ä¸º regions å¸ƒå±€ | æ›¿ä»£ CP çš„å†…å®¹è§„åˆ’ |
| æ ‡æ³¨ insightï¼ˆæ¯é¡µçš„æ ¸å¿ƒå‘ç°ï¼‰ | æ›¿ä»£ VD çš„é…è‰²/æ’ç‰ˆ |
| å‡çº§ visual ç±»å‹ï¼ˆbar_chart â†’ grouped_bar + tableï¼‰ | æ¸²æŸ“ PPTX |

---

## 5. æ¶æ„è®¾è®¡

### 5.1 Schema v2 è®¾è®¡ï¼ˆå‘åå…¼å®¹ï¼‰

Schema v2 åœ¨ v1 åŸºç¡€ä¸Š**æ–°å¢å¯é€‰å­—æ®µ**ï¼Œä¸ä¿®æ”¹ä»»ä½• v1 å­—æ®µï¼š

```jsonc
// slide å±‚çº§æ–°å¢å­—æ®µ
{
  "slide_id": 1,
  "title": "å‚¨èƒ½æŠ€æœ¯è·¯çº¿å¯¹æ¯”",              // â† v1 ä¿ç•™
  
  // ===== v2 æ–°å¢å­—æ®µï¼ˆå‡å¯é€‰ï¼‰ =====
  "assertion": "EV å¿«å……åœ¨æˆæœ¬å¯†åº¦ä¸Šé¢†å…ˆ 40%", // æ–­è¨€å¼æ ‡é¢˜
  "insight": "é”‚ç”µæ± æŠ€æœ¯åœ¨ 2025 å¹´æˆæœ¬ä¸‹é™...", // é¡µé¢æ ¸å¿ƒæ´å¯Ÿ
  "layout_intent": {
    "template": "two-region-split",         // å¸ƒå±€æ¨¡æ¿å
    "regions": [
      {
        "id": "main",
        "position": "left-60",
        "renderer": "comparison_table",
        "data_source": "components.comparison_items"
      },
      {
        "id": "side",
        "position": "right-40",
        "renderer": "callout_stack",
        "data_source": "components.callouts"
      }
    ]
  },
  
  "slide_type": "comparison",              // â† v1 ä¿ç•™ï¼ˆv2 é™çº§æ—¶ä½¿ç”¨ï¼‰
  "content": [...],                         // â† v1 ä¿ç•™
  "components": {...}                       // â† v1 ä¿ç•™
}
```

**ç‰ˆæœ¬æ£€æµ‹é€»è¾‘**ï¼š

```python
def detect_schema_version(slide: dict) -> int:
    """æ¸²æŸ“å™¨è‡ªåŠ¨æ£€æµ‹ slide çš„ schema ç‰ˆæœ¬"""
    if "layout_intent" in slide and "regions" in slide.get("layout_intent", {}):
        return 2
    return 1

def render_slide(slide: dict):
    version = detect_schema_version(slide)
    if version == 2:
        render_slide_v2(slide)    # åŒºåŸŸç»„åˆæ¸²æŸ“
    else:
        render_slide_v1(slide)    # åŸæœ‰ RENDERERS[slide_type] åˆ†å‘
```

### 5.2 æ¸²æŸ“å™¨æ¶æ„å‡çº§

#### 5.2.1 åŸç”Ÿå›¾è¡¨æ›¿ä»£ matplotlib

**æœ€é«˜ ROI å•é¡¹æ”¹è¿›**ã€‚å°† matplotlib ä½å›¾æ›¿æ¢ä¸º `python-pptx` åŸç”Ÿå›¾è¡¨ APIï¼š

```python
# å½“å‰ï¼ˆmatplotlib â†’ PNG â†’ åµŒå…¥ï¼‰ï¼š
def generate_chart_image(visual, width, height):
    fig, ax = plt.subplots()
    ax.bar(labels, values)
    buf = BytesIO()
    fig.savefig(buf, format='png')
    return buf

# ç›®æ ‡ï¼ˆpython-pptx åŸç”Ÿå›¾è¡¨ï¼‰ï¼š
from pptx.chart.data import CategoryChartData
from pptx.enum.chart import XL_CHART_TYPE

def render_native_chart(slide, visual, left, top, width, height):
    chart_data = CategoryChartData()
    chart_data.categories = visual["placeholder_data"]["labels"]
    chart_data.add_series("Series 1", visual["placeholder_data"]["values"])
    chart = slide.shapes.add_chart(
        XL_CHART_TYPE.COLUMN_CLUSTERED,
        Inches(left), Inches(top), Inches(width), Inches(height),
        chart_data
    ).chart
    # åº”ç”¨ MD3 é…è‰²
    apply_chart_theme(chart, section_accent)
```

**æ”¯æŒçš„åŸç”Ÿå›¾è¡¨ç±»å‹**ï¼š

| python-pptx æšä¸¾ | å¯¹åº”é¡µé¢åœºæ™¯ |
|-------------------|-------------|
| `COLUMN_CLUSTERED` | æŠ€æœ¯å¯¹æ¯”ã€æ€§èƒ½æ•°æ® |
| `BAR_CLUSTERED` | æ°´å¹³å¯¹æ¯” |
| `LINE` | è¶‹åŠ¿ã€æ—¶é—´åºåˆ— |
| `PIE` | å æ¯”ã€ä»½é¢ |
| `DOUGHNUT` | å æ¯”ï¼ˆå˜ä½“ï¼‰ |
| `RADAR` | å¤šç»´è¯„ä¼° |
| `XY_SCATTER` | æ•£ç‚¹åˆ†å¸ƒ |

#### 5.2.2 åŒºåŸŸç»„åˆæ¸²æŸ“å¼•æ“

æ›¿ä»£ `RENDERERS[slide_type]` ç±»å‹æ´¾å‘ï¼Œå®ç°åŸºäº `layout_intent.regions[]` çš„ç»„åˆæ¸²æŸ“ï¼š

```python
# åŒºåŸŸæ¸²æŸ“å™¨æ³¨å†Œè¡¨
REGION_RENDERERS = {
    "chart":            render_region_chart,       # åŸç”Ÿå›¾è¡¨
    "comparison_table": render_region_comparison,   # å¯¹æ¯”è¡¨æ ¼
    "kpi_row":          render_region_kpi,          # KPI å¡ç‰‡è¡Œ
    "callout_stack":    render_region_callout,      # Callout å åŠ 
    "progression":      render_region_progression,  # æ¸è¿›/æ—¶é—´çº¿
    "architecture":     render_region_architecture, # æ¶æ„å›¾ï¼ˆshapesï¼‰
    "flow":             render_region_flow,         # æµç¨‹å›¾ï¼ˆshapesï¼‰
    "bullet_list":      render_region_bullets,      # ç»“æ„åŒ–è¦ç‚¹
}

def render_slide_v2(slide: dict):
    """v2 åŒºåŸŸç»„åˆæ¸²æŸ“"""
    # 1. æ¸²æŸ“æ–­è¨€æ ‡é¢˜
    if slide.get("assertion"):
        render_assertion_title(slide)
    else:
        render_label_title(slide)
    
    # 2. æ¸²æŸ“æ´å¯Ÿæ¡
    if slide.get("insight"):
        render_insight_bar(slide)
    
    # 3. æŒ‰åŒºåŸŸé€ä¸ªæ¸²æŸ“
    for region in slide["layout_intent"]["regions"]:
        renderer = REGION_RENDERERS[region["renderer"]]
        bounds = compute_region_bounds(region["position"])
        data = resolve_data_source(slide, region["data_source"])
        renderer(pptx_slide, data, bounds)
```

**å¸ƒå±€æ¨¡æ¿é¢„è®¾**ï¼š

| æ¨¡æ¿å | åŒºåŸŸé…ç½® | å…¸å‹ç”¨é€” |
|--------|----------|----------|
| `full-width` | main: 100% | å¤§å›¾è¡¨ã€æ¶æ„å›¾ |
| `two-region-split` | left: 60%, right: 40% | å›¾è¡¨+è¦ç‚¹ |
| `two-region-equal` | left: 50%, right: 50% | åŒåˆ—å¯¹æ¯” |
| `three-region-top` | top: 30%, left: 35%, right: 35% | KPI è¡Œ + åŒå›¾ |
| `grid-2x2` | 4 ç­‰åˆ† | å¤šç»´å¯¹æ¯”çŸ©é˜µ |
| `t-shape` | top: 25%, bottom-left: 50%, bottom-right: 50% | æ ‡é¢˜+åŒåŒºåŸŸ |

#### 5.2.3 Shapes æ¸²æŸ“å¼•æ“

å°† Mermaid è¯­æ³•/æ–‡å­—æè¿°è½¬æ¢ä¸º `python-pptx` åŸç”Ÿ AutoShapeï¼š

```python
def render_region_architecture(pptx_slide, data, bounds):
    """æ¸²æŸ“æ¶æ„å›¾ï¼šæ¡† + ç®­å¤´ + æ–‡å­—æ ‡æ³¨"""
    for node in data["nodes"]:
        shape = pptx_slide.shapes.add_shape(
            MSO_AUTO_SHAPE_TYPE.ROUNDED_RECTANGLE,
            Inches(node["x"]), Inches(node["y"]),
            Inches(node["w"]), Inches(node["h"])
        )
        shape.text = node["label"]
        apply_shape_style(shape, node.get("style", "primary"))
    
    for edge in data["edges"]:
        connector = pptx_slide.shapes.add_connector(
            MSO_CONNECTOR_TYPE.STRAIGHT,
            Inches(edge["x1"]), Inches(edge["y1"]),
            Inches(edge["x2"]), Inches(edge["y2"])
        )
        add_arrowhead(connector)
```

### 5.3 Agent è°ƒæ•´æ–¹æ¡ˆ

#### 5.3.1 Content Planner (CP) â€” ä¸ä¿®æ”¹

CP ä¿æŒåŸæ ·ï¼Œç»§ç»­äº§å‡ºï¼š
- `slides.md`ï¼šè·¨å¹³å°å¯è¯»çš„æ¼”ç¤ºå¤§çº²ï¼ˆå¯å–‚ç»™ä»»ä½•å·¥å…·ï¼‰
- `slides_semantic.json` (v1)ï¼šç»“æ„åŒ–ä¸­é—´è¡¨ç¤º

**ç†ç”±**ï¼š
- `slides.md` æ˜¯å®è´µçš„è·¨å¹³å°èµ„äº§
- CP å·²æœ‰ç¨³å®šçš„ 17 æ¡è‡ªæ£€è§„åˆ™
- å†…å®¹å¢å¼ºç”±æ–°å¢çš„ EA Agent æ‰¿æ‹…

#### 5.3.2 Exhibit Architect (EA) â€” æ–°å¢

```yaml
# EA Agent æ ¸å¿ƒèŒè´£
name: exhibit-architect
type: æ–°å¢ Agentï¼ˆå¯é€‰å¢å¼ºå±‚ï¼‰
input: slides_semantic.json (v1) + slides.md
output: slides_semantic.json (v2)

capabilities:
  - assertion_extraction:
      description: ä» bullets ä¸­æç‚¼ assertion title
      method: "æ‰¾åˆ°æ¯é¡µçš„'æ‰€ä»¥å‘¢ï¼Ÿ'(So What?) â†’ ä¸€å¥è¯æ–­è¨€"
      example: 
        before: "å‚¨èƒ½æŠ€æœ¯è·¯çº¿å¯¹æ¯”"
        after: "EV å¿«å……åœ¨æˆæœ¬å¯†åº¦ä¸Šé¢†å…ˆ 40%ï¼Œä½†å¾ªç¯å¯¿å‘½ä»åˆ¶çº¦è§„æ¨¡åŒ–"
  
  - page_merging:
      description: åˆå¹¶ä¿¡æ¯å¯†åº¦ä¸è¶³çš„ç›¸é‚»é¡µ
      rules:
        - "åŒ section å†…çš„çº¯ bullet é¡µ â†’ åˆå¹¶"
        - "KPI é¡µ + è¯´æ˜é¡µ â†’ åˆå¹¶ä¸º KPI+callout å¤åˆé¡µ"
        - "å¯¹æ¯”é¡µ + æ•°æ®é¡µ â†’ åˆå¹¶ä¸º chart+table å¤åˆé¡µ"
      target: "23 é¡µ â†’ 12-15 é¡µ"
  
  - visual_upgrade:
      description: å‡çº§å¯è§†åŒ–ç±»å‹é€‰æ‹©
      rules:
        - "å¤šç³»åˆ— bar_chart â†’ grouped_bar + inline_table"
        - "çº¯ bullets â‰¥ 5 æ¡ â†’ icon_grid æˆ– process_flow"
        - "timeline + milestone â†’ gantt_simplified"
  
  - layout_design:
      description: ä¸ºæ¯é¡µè®¾è®¡ layout_intent (åŒºåŸŸå¸ƒå±€)
      method: "æ ¹æ®ç»„ä»¶æ•°é‡å’Œç±»å‹é€‰æ‹©æœ€ä½³å¸ƒå±€æ¨¡æ¿"
```

#### 5.3.3 Creative Director (CD) â€” å¾®è°ƒç¼–æ’

CD æ–°å¢ EA è°ƒåº¦é€»è¾‘ï¼š

```
åŸæœ‰æµç¨‹ï¼šCD â†’ CP â†’ VD â†’ PS
æ–°å¢æµç¨‹ï¼šCD â†’ CP â†’ EA(å¯é€‰) â†’ VD â†’ PS
```

CD å†³å®šæ˜¯å¦å¯ç”¨ EA çš„åˆ¤æ–­æ¡ä»¶ï¼š
- é»˜è®¤å¯ç”¨ EA
- ç”¨æˆ·æ˜¾å¼è¦æ±‚"å¿«é€Ÿ/ç®€å•ç‰ˆ"æ—¶è·³è¿‡ EA
- slides.md ä¸è¶³ 10 é¡µæ—¶è·³è¿‡ EAï¼ˆä¿¡æ¯é‡ä¸è¶³ä»¥å‹ç¼©ï¼‰

#### 5.3.4 PPT Specialist (PS) â€” é€‚é… v2

PS éœ€è¦æ„ŸçŸ¥ Schema ç‰ˆæœ¬ï¼š

```
v1 è·¯å¾„ï¼šç›´æ¥è°ƒç”¨ generate_pptx.pyï¼ˆç°æœ‰é€»è¾‘ï¼‰
v2 è·¯å¾„ï¼šè°ƒç”¨ generate_pptx.pyï¼ˆè‡ªåŠ¨æ£€æµ‹å¹¶ä½¿ç”¨åŒºåŸŸæ¸²æŸ“ï¼‰
```

### 5.4 Skill è°ƒæ•´æ–¹æ¡ˆ

| Skill | è°ƒæ•´å†…å®¹ |
|-------|----------|
| `ppt-content-planning` | ä¸ä¿®æ”¹ |
| `ppt-design-system` | æ–°å¢åŒºåŸŸå¸ƒå±€æ¨¡æ¿å®šä¹‰ |
| `ppt-visual-taxonomy` | æ–°å¢å¤åˆå¯è§†åŒ–ç±»å‹ï¼ˆgrouped_bar+table ç­‰ï¼‰ |
| `ppt-generator` | æ–°å¢åŸç”Ÿå›¾è¡¨ API æ–‡æ¡£ã€åŒºåŸŸæ¸²æŸ“å™¨æ¥å£ã€shapes ç»˜åˆ¶ API |

---

## 6. å®æ–½è·¯çº¿å›¾

### 6.1 å…¨å±€è§†å›¾

```
Week  1   2   3   4   5   6   7   8   9  10  11  12  13  14
     â”œâ”€â”€â”€â”€â”€â”€â”€â”¤                                              P0: åŸç”Ÿå›¾è¡¨
             â”œâ”€â”€â”€â”€â”€â”€â”€â”¤                                      P1: æ–­è¨€ + æ´å¯Ÿ
                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      P2: EA Agent
                                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     P3: åŒºåŸŸå¼•æ“
                                                     â”œâ”€â”€â”€â”€â”€P4: Shapes æ¸²æŸ“
                                                       â”œâ”€â”€â”€P5: åé¦ˆé—­ç¯
```

### 6.2 P0ï¼šåŸç”Ÿå›¾è¡¨æ›¿ä»£ï¼ˆç¬¬ 1-2 å‘¨ï¼‰

**ç›®æ ‡**ï¼šå°† matplotlib â†’ PNG â†’ embed æ›¿æ¢ä¸º `python-pptx` åŸç”Ÿå›¾è¡¨ã€‚

**æ”¹åŠ¨èŒƒå›´**ï¼š

| æ–‡ä»¶ | æ”¹åŠ¨ |
|------|------|
| `generate_pptx.py` | æ–°å¢ `render_native_chart()`ï¼›æ”¹é€  `render_visual()` ä¼˜å…ˆèµ°åŸç”Ÿè·¯å¾„ |
| `ppt-generator/README.md` | æ›´æ–°æ¸²æŸ“æ–‡æ¡£ï¼Œæ ‡æ³¨åŸç”Ÿ vs ä½å›¾è·¯å¾„ |

**å®æ–½æ­¥éª¤**ï¼š

1. åœ¨ `generate_pptx.py` ä¸­æ–°å¢ `render_native_chart()` å‡½æ•°ï¼Œæ”¯æŒ 7 ç§å›¾è¡¨ç±»å‹
2. æ–°å¢ `apply_chart_theme()` å°† MD3 é…è‰²åº”ç”¨äºåŸç”Ÿå›¾è¡¨
3. ä¿®æ”¹ `render_visual()` çš„åˆ†å‘é€»è¾‘ï¼šä¼˜å…ˆå°è¯•åŸç”Ÿï¼Œä¸æ”¯æŒçš„ç±»å‹ fallback matplotlib
4. ç”Ÿæˆå¯¹æ¯” PPTXï¼ŒéªŒè¯åŸç”Ÿå›¾è¡¨è§†è§‰æ•ˆæœ
5. æ›´æ–° `ppt-generator/README.md` æ–‡æ¡£

**éªŒæ”¶æ ‡å‡†**ï¼š
- æ‰€æœ‰æ•°æ®é¡µä½¿ç”¨åŸç”Ÿå›¾è¡¨ï¼ˆé PNGï¼‰
- å›¾è¡¨å¯åœ¨ PowerPoint ä¸­åŒå‡»ç¼–è¾‘
- é…è‰²ä¸ MD3 ä¸»é¢˜ä¸€è‡´

**é£é™©**ï¼š`python-pptx` çš„å›¾è¡¨ API ä¸æ”¯æŒå…¨éƒ¨ matplotlib å›¾è¡¨ç±»å‹ï¼ˆå¦‚çƒ­åŠ›å›¾ã€æ¡‘åŸºå›¾ï¼‰â†’ ä¿ç•™ matplotlib ä½œä¸º fallbackã€‚

### 6.3 P1ï¼šæ–­è¨€æ ‡é¢˜ + æ´å¯Ÿæç‚¼ï¼ˆç¬¬ 3-4 å‘¨ï¼‰

**ç›®æ ‡**ï¼šå¼•å…¥ `assertion` å’Œ `insight` å­—æ®µåŠå…¶æ¸²æŸ“ã€‚

**æ”¹åŠ¨èŒƒå›´**ï¼š

| æ–‡ä»¶ | æ”¹åŠ¨ |
|------|------|
| `slides-render-schema.json` | æ–°å¢ `assertion`ã€`insight` å¯é€‰å­—æ®µ |
| `generate_pptx.py` | æ–°å¢ `render_assertion_title()`ã€`render_insight_bar()` |
| `ppt-content-planning/README.md` | æ–°å¢æ–­è¨€æå–æŒ‡å—ï¼ˆä¾› EA å‚è€ƒï¼‰ |

**å®æ–½æ­¥éª¤**ï¼š

1. åœ¨ Schema ä¸­æ·»åŠ  `assertion` (string, optional) å’Œ `insight` (string, optional) å­—æ®µ
2. å®ç° `render_assertion_title()`ï¼š16pt ç²—ä½“æ–­è¨€ + 10pt æµ…è‰²åŸæ ‡é¢˜
3. å®ç° `render_insight_bar()`ï¼šåº•éƒ¨æ·±è‰²æ¡ï¼Œ10pt ç™½å­—æ´å¯Ÿ
4. ä¿®æ”¹æ¸²æŸ“å…¥å£ï¼šæ£€æµ‹ `assertion` å­—æ®µ â†’ ä½¿ç”¨æ–­è¨€æ ‡é¢˜æ¸²æŸ“

**ç‰ˆæœ¬å…¼å®¹**ï¼š
- æ—  `assertion` å­—æ®µ â†’ æ­£å¸¸ä½¿ç”¨ `title` æ¸²æŸ“ï¼ˆv1 è¡Œä¸ºï¼‰
- æœ‰ `assertion` å­—æ®µ â†’ ä½¿ç”¨æ–­è¨€æ ‡é¢˜æ¸²æŸ“ï¼ˆv2 è¡Œä¸ºï¼‰

### 6.4 P2ï¼šExhibit Architect Agentï¼ˆç¬¬ 5-7 å‘¨ï¼‰

**ç›®æ ‡**ï¼šåˆ›å»º EA Agentï¼Œå®ç° v1â†’v2 çš„å†…å®¹å¢å¼ºã€‚

**äº¤ä»˜ç‰©**ï¼š

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `agents/ppt-exhibit-architect.agent.md` | EA Agent å®šä¹‰ |
| `skills/ppt-exhibit-design/README.md` | å±•ç¤ºè®¾è®¡æŠ€èƒ½è§„èŒƒ |

**EA å¤„ç†æµç¨‹**ï¼š

```
è¾“å…¥ï¼šslides_semantic.json (v1, 23 slides)
  â”‚
  â”œâ”€ Step 1: Assertion Extraction
  â”‚    å¯¹æ¯é¡µ bullets æé—® "So What?"
  â”‚    â†’ æç‚¼ assertion å­—æ®µ
  â”‚
  â”œâ”€ Step 2: Page Merging
  â”‚    è¯†åˆ«å¯åˆå¹¶çš„ç›¸é‚»é¡µ
  â”‚    â†’ 23 â†’ 12-15 é¡µ
  â”‚
  â”œâ”€ Step 3: Insight Annotation
  â”‚    ä¸ºæ¯é¡µæ ‡æ³¨æ ¸å¿ƒå‘ç°
  â”‚    â†’ å¡«å…… insight å­—æ®µ
  â”‚
  â”œâ”€ Step 4: Visual Upgrade
  â”‚    å‡çº§å¯è§†åŒ–ç±»å‹é€‰æ‹©
  â”‚    â†’ æ›´æ–° visual.type + å¢åŠ å¤åˆç»„åˆ
  â”‚
  â””â”€ Step 5: Layout Design
       ä¸ºæ¯é¡µåˆ†é…åŒºåŸŸå¸ƒå±€
       â†’ å¡«å…… layout_intent
  
è¾“å‡ºï¼šslides_semantic.json (v2, 12-15 slides)
```

**EA è‡ªæ£€è§„åˆ™ï¼ˆè‰æ¡ˆï¼‰**ï¼š

| ç¼–å· | è§„åˆ™ | å¼ºåº¦ |
|------|------|------|
| EA-0 | ä¸ä¿®æ”¹ slides.mdï¼ˆåªè¯»å‚è€ƒï¼‰ | å¼ºåˆ¶ |
| EA-1 | ä¸åˆ›é€ ä¸å­˜åœ¨äºåŸæ–‡çš„æ•°æ®/äº‹å® | å¼ºåˆ¶ |
| EA-2 | assertion å¿…é¡»å¯ä» bullets ä¸­æ¨å¯¼ | å¼ºåˆ¶ |
| EA-3 | åˆå¹¶åé¡µæ•° â‰¤ åŸé¡µæ•° Ã— 0.65 | å»ºè®® |
| EA-4 | æ¯é¡µè‡³å°‘ 2 ä¸ªåŒºåŸŸ | å»ºè®® |
| EA-5 | assertion â‰  åŸ title çš„ç®€å•å¤è¿° | å¼ºåˆ¶ |

### 6.5 P3ï¼šåŒºåŸŸç»„åˆæ¸²æŸ“å¼•æ“ï¼ˆç¬¬ 8-10 å‘¨ï¼‰

**ç›®æ ‡**ï¼šå®ç°åŸºäº `layout_intent.regions[]` çš„å¤åˆæ¸²æŸ“ã€‚

**æ”¹åŠ¨èŒƒå›´**ï¼š

| æ–‡ä»¶ | æ”¹åŠ¨ |
|------|------|
| `slides-render-schema.json` | æ–°å¢ `layout_intent`ã€`regions` å®šä¹‰ |
| `generate_pptx.py` | æ–°å¢ `render_slide_v2()`ã€8 ä¸ªåŒºåŸŸæ¸²æŸ“å™¨ã€å¸ƒå±€æ¨¡æ¿ç³»ç»Ÿ |
| `ppt-design-system/README.md` | æ–°å¢ 6 ç§å¸ƒå±€æ¨¡æ¿è§„èŒƒ |

**å…³é”®å®ç°**ï¼š

1. **å¸ƒå±€æ¨¡æ¿è§£æå™¨**ï¼šå°† `"left-60"` ç­‰ä½ç½®æ ‡è®°è½¬æ¢ä¸ºåƒç´ åæ ‡
2. **8 ä¸ªåŒºåŸŸæ¸²æŸ“å™¨**ï¼šè§ [é™„å½• B](#é™„å½•-b-åŒºåŸŸæ¸²æŸ“å™¨æ¸…å•)
3. **æ•°æ®æºè§£æ**ï¼š`"components.comparison_items"` â†’ åŠ¨æ€å–å€¼
4. **å›é€€ç­–ç•¥**ï¼šæ—  `layout_intent` â†’ èµ° v1 `RENDERERS[slide_type]`

### 6.6 P4ï¼šShapes æ¸²æŸ“ï¼ˆç¬¬ 11-12 å‘¨ï¼‰

**ç›®æ ‡**ï¼šå°†æ¶æ„å›¾ã€æµç¨‹å›¾ä»æ–‡å­—æè¿°è½¬ä¸ºåŸç”Ÿ AutoShapeã€‚

**æ”¹åŠ¨èŒƒå›´**ï¼š

| æ–‡ä»¶ | æ”¹åŠ¨ |
|------|------|
| `generate_pptx.py` | æ–°å¢ `render_region_architecture()`ã€`render_region_flow()` |
| `ppt-visual-taxonomy/README.md` | æ–°å¢ shapes ç±»å¯è§†åŒ–ç±»å‹å®šä¹‰ |
| Schema | `components` æ–°å¢ `architecture_data`ã€`flow_data` å®šä¹‰ |

**æ”¯æŒçš„å›¾å½¢å…ƒç´ **ï¼š
- åœ†è§’çŸ©å½¢ï¼ˆèŠ‚ç‚¹/æ¨¡å—ï¼‰
- ç›´çº¿/æŠ˜çº¿è¿æ¥å™¨ï¼ˆå¸¦ç®­å¤´ï¼‰
- 2Ã—2 çŸ©é˜µï¼ˆå››è±¡é™å›¾ï¼‰
- æ¼æ–—å›¾ï¼ˆMSO_AUTO_SHAPE_TYPE.FUNNEL ç­‰ï¼‰

### 6.7 P5ï¼šåé¦ˆé—­ç¯ï¼ˆç¬¬ 13-14 å‘¨ï¼‰

**ç›®æ ‡**ï¼šå»ºç«‹ PPT è´¨é‡åº¦é‡å’ŒæŒç»­ä¼˜åŒ–æœºåˆ¶ã€‚

**å®ç°æ–¹æ¡ˆ**ï¼š

```python
# åº¦é‡è®°å½•æ ¼å¼ (metrics.jsonl)
{
    "timestamp": "2026-03-15T10:30:00Z",
    "deck_id": "storage-frontier-20260211",
    "schema_version": 2,
    "total_slides": 14,
    "metrics": {
        "assertion_title_rate": 0.85,    # æ–­è¨€æ ‡é¢˜è¦†ç›–ç‡
        "native_visual_rate": 0.80,      # åŸç”Ÿå¯è§†åŒ–è¦†ç›–ç‡
        "compression_ratio": 0.35,       # é¡µé¢å‹ç¼©æ¯”
        "placeholder_rate": 0.05,        # å ä½ç¬¦æ®‹ç•™ç‡
        "multi_region_rate": 0.70,       # å¤šåŒºåŸŸé¡µå æ¯”
        "avg_components_per_slide": 2.3  # å¹³å‡ç»„ä»¶æ•°/é¡µ
    }
}
```

**å®¡è®¡è§„åˆ™**ï¼š

| æŒ‡æ ‡ | é»„çº¿ | çº¢çº¿ | è§¦å‘åŠ¨ä½œ |
|------|------|------|----------|
| assertion_title_rate | < 70% | < 50% | æç¤º EA å¢å¼ºæç‚¼ |
| native_visual_rate | < 60% | < 40% | æ£€æŸ¥å›¾è¡¨ç±»å‹è¦†ç›– |
| compression_ratio | > 0.5 | > 0.7 | æç¤º EA åŠ å¼ºåˆå¹¶ |
| placeholder_rate | > 10% | > 20% | æç¤ºå¢åŠ æ¸²æŸ“å™¨è¦†ç›– |

---

## 7. KPI ä½“ç³»

### 7.1 æ ¸å¿ƒæŒ‡æ ‡

| æŒ‡æ ‡ | å®šä¹‰ | å½“å‰å€¼ | P0 å | P2 å | P5 åï¼ˆç›®æ ‡ï¼‰ |
|------|------|--------|-------|-------|--------------|
| **assertion_title_rate** | ä½¿ç”¨æ–­è¨€æ ‡é¢˜çš„é¡µé¢å æ¯” | 0% | 0% | 70% | â‰¥85% |
| **native_visual_rate** | ä½¿ç”¨åŸç”Ÿå›¾è¡¨/shapes çš„å¯è§†åŒ–å æ¯” | 0% | 60% | 70% | â‰¥80% |
| **compression_ratio** | è¾“å‡ºé¡µæ•°/è¾“å…¥æ®µè½æ•° | 0.92 | 0.92 | 0.45 | â‰¤0.40 |
| **placeholder_rate** | ä»ä½¿ç”¨æ–‡å­—å ä½ç¬¦çš„å¯è§†åŒ–å æ¯” | 40% | 20% | 10% | â‰¤5% |
| **multi_region_rate** | ä½¿ç”¨å¤šåŒºåŸŸå¤åˆå¸ƒå±€çš„é¡µé¢å æ¯” | 0% | 0% | 50% | â‰¥65% |
| **avg_components_per_slide** | æ¯é¡µå¹³å‡ç»„ä»¶æ•° | 1.2 | 1.2 | 2.0 | â‰¥2.3 |

### 7.2 è´¨é‡é‡Œç¨‹ç¢‘

| é‡Œç¨‹ç¢‘ | è¾¾æˆæ¡ä»¶ | é¢„æœŸæ—¶é—´ |
|--------|----------|----------|
| **M1: å›¾è¡¨å¹³æƒ** | native_visual_rate â‰¥ 60% | P0 å®Œæˆ |
| **M2: æ ‡é¢˜å‡çº§** | assertion_title_rate â‰¥ 70% | P2 å®Œæˆ |
| **M3: å¯†åº¦è¿½å¹³** | compression_ratio â‰¤ 0.45 | P2 å®Œæˆ |
| **M4: å¸ƒå±€è¿½å¹³** | multi_region_rate â‰¥ 50% | P3 å®Œæˆ |
| **M5: å…¨é¢è¾¾æ ‡** | æ‰€æœ‰ KPI è¾¾æ ‡ | P5 å®Œæˆ |

---

## 8. é£é™©ä¸ç¼“è§£

| é£é™© | æ¦‚ç‡ | å½±å“ | ç¼“è§£ç­–ç•¥ |
|------|------|------|----------|
| `python-pptx` å›¾è¡¨ API ä¸æ”¯æŒæŸäº›å›¾è¡¨ç±»å‹ | ä¸­ | ä¸­ | ä¿ç•™ matplotlib fallbackï¼›é€æ­¥è¦†ç›– |
| EA æ–­è¨€æå–è´¨é‡ä¸ç¨³å®š | ä¸­ | é«˜ | EA-5 è‡ªæ£€è§„åˆ™ + CD å®¡æ ¸ç¯èŠ‚ |
| EA è¿‡åº¦åˆå¹¶å¯¼è‡´ä¿¡æ¯ä¸¢å¤± | ä½ | é«˜ | EA-1 å¼ºåˆ¶ä¸ä¸¢æ•°æ® + ç”¨æˆ·å¯é€‰è·³è¿‡ EA |
| åŒºåŸŸå¸ƒå±€åœ¨ä¸åŒåˆ†è¾¨ç‡ä¸‹é”™ä½ | ä¸­ | ä¸­ | åŸºäº 12 æ ç½‘æ ¼çš„ç›¸å¯¹å®šä½ |
| v1/v2 æ¸²æŸ“è·¯å¾„ç»´æŠ¤æˆæœ¬ | ä½ | ä½ | v1 ä»£ç å†»ç»“ï¼Œåªä¿® bugï¼›æ–°åŠŸèƒ½åªåŠ  v2 |
| LLM ä¸Šä¸‹æ–‡é•¿åº¦é™åˆ¶å½±å“ EA å¤„ç†é•¿æ–‡æ¡£ | ä¸­ | ä¸­ | EA æŒ‰ section åˆ†æ‰¹å¤„ç† |

---

## é™„å½• Aï¼šSchema v2 å­—æ®µå®šä¹‰

### slide çº§æ–°å¢å­—æ®µ

```jsonc
{
  // v2 æ–°å¢å­—æ®µï¼Œå…¨éƒ¨ optional
  "assertion": {
    "type": "string",
    "description": "æ–­è¨€å¼æ ‡é¢˜ â€”â€” ä¸€å¥è¯æ¦‚æ‹¬æœ¬é¡µæ ¸å¿ƒå‘ç°/ç»“è®ºã€‚æ¸²æŸ“ä¸º 16pt ç²—ä½“ä¸»æ ‡é¢˜ï¼ŒåŸ title é™ä¸º 10pt å‰¯æ ‡é¢˜ã€‚"
  },
  "insight": {
    "type": "string",
    "description": "é¡µé¢æ´å¯Ÿ â€”â€” è¡¥å……è¯´æ˜æ–­è¨€çš„ä¾æ®æˆ–å¯ç¤ºã€‚æ¸²æŸ“ä¸ºåº•éƒ¨æ·±è‰²æ¡å¸¦ç™½å­—ã€‚"
  },
  "layout_intent": {
    "type": "object",
    "description": "åŒºåŸŸå¸ƒå±€æ„å›¾ â€”â€” æŒ‡å¯¼æ¸²æŸ“å™¨å¦‚ä½•ç»„åˆåŒºåŸŸã€‚",
    "properties": {
      "template": {
        "type": "string",
        "enum": ["full-width", "two-region-split", "two-region-equal", 
                 "three-region-top", "grid-2x2", "t-shape"],
        "description": "å¸ƒå±€æ¨¡æ¿å"
      },
      "regions": {
        "type": "array",
        "items": {
          "type": "object",
          "required": ["id", "position", "renderer", "data_source"],
          "properties": {
            "id": { "type": "string", "description": "åŒºåŸŸæ ‡è¯†" },
            "position": { 
              "type": "string", 
              "description": "ä½ç½®æè¿°ï¼Œå¦‚ 'left-60', 'right-40', 'top-30', 'full'"
            },
            "renderer": { 
              "type": "string",
              "enum": ["chart", "comparison_table", "kpi_row", "callout_stack",
                       "progression", "architecture", "flow", "bullet_list"],
              "description": "åŒºåŸŸæ¸²æŸ“å™¨ç±»å‹"
            },
            "data_source": {
              "type": "string",
              "description": "æ•°æ®æ¥æºè·¯å¾„ï¼Œå¦‚ 'components.kpis', 'visual'"
            }
          }
        }
      }
    }
  }
}
```

### components æ–°å¢ç±»å‹

```jsonc
{
  // æ–°å¢åˆ° definitions.components.properties
  "architecture_data": {
    "type": "object",
    "description": "æ¶æ„å›¾æ•°æ® â€”â€” èŠ‚ç‚¹ + è¿çº¿",
    "properties": {
      "nodes": {
        "type": "array",
        "items": {
          "type": "object",
          "required": ["id", "label"],
          "properties": {
            "id": { "type": "string" },
            "label": { "type": "string" },
            "x": { "type": "number" },
            "y": { "type": "number" },
            "w": { "type": "number" },
            "h": { "type": "number" },
            "style": { "type": "string", "enum": ["primary", "secondary", "tertiary", "outline"] }
          }
        }
      },
      "edges": {
        "type": "array",
        "items": {
          "type": "object",
          "required": ["from", "to"],
          "properties": {
            "from": { "type": "string" },
            "to": { "type": "string" },
            "label": { "type": "string" },
            "style": { "type": "string", "enum": ["solid", "dashed"] }
          }
        }
      }
    }
  },
  "flow_data": {
    "type": "object",
    "description": "æµç¨‹å›¾æ•°æ® â€”â€” æ­¥éª¤ + ç®­å¤´",
    "properties": {
      "steps": {
        "type": "array",
        "items": {
          "type": "object",
          "required": ["id", "label"],
          "properties": {
            "id": { "type": "string" },
            "label": { "type": "string" },
            "type": { "type": "string", "enum": ["start", "process", "decision", "end"] }
          }
        }
      },
      "transitions": {
        "type": "array",
        "items": {
          "type": "object",
          "required": ["from", "to"],
          "properties": {
            "from": { "type": "string" },
            "to": { "type": "string" },
            "condition": { "type": "string" }
          }
        }
      }
    }
  }
}
```

---

## é™„å½• Bï¼šåŒºåŸŸæ¸²æŸ“å™¨æ¸…å•

| æ¸²æŸ“å™¨ | è¾“å…¥æ•°æ® | æ¸²æŸ“æ•ˆæœ | å¼•å…¥é˜¶æ®µ |
|--------|----------|----------|----------|
| `chart` | `visual.placeholder_data` | python-pptx åŸç”Ÿå›¾è¡¨ | P0 |
| `comparison_table` | `components.comparison_items` | MD3 é£æ ¼å¯¹æ¯”è¡¨æ ¼ | P3 |
| `kpi_row` | `components.kpis` | æ¨ªæ’ KPI å¡ç‰‡ï¼ˆå«æ¯”ä¾‹æ¡ï¼‰ | P3 |
| `callout_stack` | `components.callouts` | çºµå‘å åŠ å¼•ç”¨æ¡ | P3 |
| `progression` | `components.timeline_items` | æ—¶é—´çº¿/é‡Œç¨‹ç¢‘ç‚¹ | P3 |
| `architecture` | `components.architecture_data` | AutoShape æ¡†+ç®­å¤´æ¶æ„å›¾ | P4 |
| `flow` | `components.flow_data` | AutoShape æµç¨‹å›¾ | P4 |
| `bullet_list` | `content[]` | ç»“æ„åŒ–è¦ç‚¹åˆ—è¡¨ | P3 |

---

*æœ¬æ–‡æ¡£æ˜¯ PPT Pipeline é•¿æ•ˆä¼˜åŒ–çš„æˆ˜ç•¥è§„åˆ’ï¼Œåç»­å°†æ ¹æ®å®æ–½è¿›å±•æŒç»­æ›´æ–°ã€‚*
